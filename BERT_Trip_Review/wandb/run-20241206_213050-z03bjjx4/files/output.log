  0%|                                                                                                                                                                         | 0/37700 [00:00<?, ?it/s]
forward inputs
inputids {'input_ids': tensor([[   1,  478,  100,  117,   88,    0,   60,    3,    2,    2],
        [   1,  726,    4,    4,    0,   67,    0,    3,    2,    2],
        [   1, 1842,    4,    4,   60,    0,   71,    3,    2,    2],
        [   1,  942,  118,    4,   43,   30,   71,    0,   67,    3],
        [   1, 2118,   97,  125,   51,    0,   59,    3,    2,    2],
        [   1,  479,    4,  133,   71,    0,   72,    0,   60,    3],
        [   1, 1937,   95,   95,    0,    0,   45,   78,    3,    2],
        [   1,  896,    4,   95,   68,   42,    0,   23,   51,    3],
        [   1,  180,    4,    4,    0,   52,   67,    3,    2,    2],
        [   1, 1219,   97,   93,    0,    0,    0,   60,    0,    3],
        [   1, 2195,    4,    4,    0,    0,   60,   71,    3,    2],
        [   1,  923,    4,    4,    0,    0,   71,    3,    2,    2],
        [   1,  993,    4,    4,   60,    0,   71,   66,    0,    3],
        [   1,  763,    4,    4,   51,    0,   20,    3,    2,    2],
        [   1,  471,   97,  125,   68,   60,   72,    3,    2,    2],
        [   1,  715,    4,    4,   76,    0,   37,   15,    3,    2],
        [   1, 1771,    4,  111,   51,   81,    0,    3,    2,    2],
        [   1, 1675,  121,  117,   84,    0,   10,    3,    2,    2],
        [   1, 1438,    4,    4,    0,   91,    0,    3,    2,    2],
        [   1, 1981,    4,    4,   31,   20,    0,    3,    2,    2],
        [   1,  382,    4,    4,    0,   60,   42,    3,    2,    2],
        [   1, 1305,    4,    4,   80,   51,    0,    3,    2,    2],
        [   1, 2070,    4,    4,   82,    0,    0,    3,    2,    2],
        [   1, 1466,    4,    4,    0,   24,   10,    3,    2,    2],
        [   1,  730,    4,    4,    0,   60,    0,    3,    2,    2],
        [   1, 2253,    4,    4,   15,   37,   44,    3,    2,    2],
        [   1, 1094,    4,    4,    0,    0,   60,    7,    3,    2],
        [   1, 1691,    4,    4,   35,    0,    0,    0,    0,    3],
        [   1, 1217,    4,    4,   23,    7,   45,    3,    2,    2],
        [   1, 2090,  138,    4,    0,   46,   23,    0,    3,    2],
        [   1, 1891,    4,    4,    0,   68,   23,   60,    0,    3],
        [   1,  359,    4,    4,    0,   68,    0,    3,    2,    2]],
       device='cuda:0'), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0]], device='cuda:0'), 'aug_input_ids': tensor([[   1,  478,   97,  125,   88,   73,   80,    3,    2,    2],
        [   1, 1742,    4,    4,   72,   67,   19,    3,    2,    2],
        [   1, 2048,    4,    4,    0,   67,   71,    3,    2,    2],
        [   1,  942,  135,    4,   25,    0,   45,   67,    3,    2],
        [   1, 1077,   97,  117,   51,   68,   71,    3,    2,    2],
        [   1,  479,  111,  129,   72,   32,    0,   78,    3,    2],
        [   1,  302,   95,  105,   16,   45,   78,    3,    2,    2],
        [   1, 2069,    4,   95,    0,   68,   72,    6,    0,    3],
        [   1, 1872,    4,    4,   14,   67,   91,    3,    2,    2],
        [   1,  237,  111,   95,   21,    0,    0,    3,    2,    2],
        [   1, 2040,    4,    4,   51,   23,    0,    0,    3,    2],
        [   1, 1839,    4,    4,   68,   23,   78,    3,    2,    2],
        [   1,  431,    4,    4,   60,   14,   71,   26,   33,    3],
        [   1, 1345,    4,    4,   68,   23,   60,   31,    3,    2],
        [   1, 2181,    4,  138,   51,    0,   60,    3,    2,    2],
        [   1, 2295,    4,    4,   79,   37,   15,    3,    2,    2],
        [   1,  735,    4,  111,   51,   45,   12,    3,    2,    2],
        [   1,  976,   97,  125,   84,   89,    0,   65,    3,    2],
        [   1, 1438,    4,    4,   78,   91,   67,   42,    3,    2],
        [   1, 2080,    4,    4,   31,   20,    0,    3,    2,    2],
        [   1,  967,    4,    4,    0,   60,    0,    3,    2,    2],
        [   1, 1305,    4,    4,   80,    0,   68,    0,   71,    3],
        [   1, 2070,    4,    4,    0,    0,    0,    3,    2,    2],
        [   1, 1466,    4,    4,   80,   60,   53,    0,    3,    2],
        [   1, 1451,    4,    4,   60,   49,   19,    3,    2,    2],
        [   1,  929,    4,    4,   15,    0,   44,    3,    2,    2],
        [   1, 1094,    4,    4,   35,    0,    0,    7,    3,    2],
        [   1, 1167,    4,    4,   35,   11,    8,    3,    2,    2],
        [   1, 1542,    4,    4,   77,   42,   45,    3,    2,    2],
        [   1, 2180,  129,    4,   80,    0,   23,   78,    3,    2],
        [   1,  141,    4,    4,   51,   31,   20,    3,    2,    2],
        [   1,  359,    4,    4,    0,    0,    0,    3,    2,    2]],
       device='cuda:0'), 'aug_attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 0, 0]], device='cuda:0'), 'labels': tensor([[-100, -100, -100, -100, -100,   73, -100, -100, -100, -100],
        [-100, -100, -100, -100,   72, -100,   19, -100, -100, -100],
        [-100, -100, -100, -100, -100,   67, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   68, -100,   45, -100, -100],
        [-100, -100, -100, -100, -100,   68,   59, -100, -100, -100],
        [-100, -100, -100, -100, -100,   68, -100,   59, -100, -100],
        [-100, -100, -100, -100,   16,   71, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100,    6,   23, -100, -100],
        [-100, -100, -100, -100,   83, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   68,   43,   72, -100,   71, -100],
        [-100, -100, -100, -100,   51,   23, -100, -100, -100, -100],
        [-100, -100, -100, -100,   68,   78, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,    7, -100, -100,   33, -100],
        [-100, -100, -100, -100, -100,   68, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   60, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   79, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   45,    9, -100, -100, -100],
        [-100, -100, -100, -100, -100,   41, -100, -100, -100, -100],
        [-100, -100, -100, -100,   78, -100,   59, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100,   88, -100, -100, -100],
        [-100, -100, -100, -100,   68, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   51,   71, -100, -100, -100],
        [-100, -100, -100, -100,   82,   14,   12, -100, -100, -100],
        [-100, -100, -100, -100,   80,   60, -100, -100, -100, -100],
        [-100, -100, -100, -100,   23, -100,   71, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   35,   68, -100,    7, -100, -100],
        [-100, -100, -100, -100, -100,   84,   22,   11,    8, -100],
        [-100, -100, -100, -100, -100,   42,   45, -100, -100, -100],
        [-100, -100, -100, -100,   80,   68, -100,   60, -100, -100],
        [-100, -100, -100, -100,   51, -100, -100, -100,   31, -100],
        [-100, -100, -100, -100,   80, -100,   71, -100, -100, -100]],
       device='cuda:0'), 'aug_labels': tensor([[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   60, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   68,   71, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   59,   60, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   71, -100, -100, -100,   51, -100],
        [-100, -100, -100, -100,   52, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   43,   60,   71, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100,   60,   71, -100, -100],
        [-100, -100, -100, -100, -100,   23, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100,   66, -100, -100],
        [-100, -100, -100, -100, -100, -100,   60, -100, -100, -100],
        [-100, -100, -100, -100, -100,   23, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100,    9, -100, -100, -100],
        [-100, -100, -100, -100, -100,   41,   10, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100,   88, -100, -100, -100],
        [-100, -100, -100, -100,   68, -100,   42, -100, -100, -100],
        [-100, -100, -100, -100, -100,   51, -100,   23, -100, -100],
        [-100, -100, -100, -100,   82,   14,   12, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100,   10, -100, -100],
        [-100, -100, -100, -100, -100,   72,   71, -100, -100, -100],
        [-100, -100, -100, -100, -100,   37, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100,   68,   60, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   23, -100,   45, -100, -100, -100],
        [-100, -100, -100, -100, -100,   68, -100, -100, -100, -100],
        [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100],
        [-100, -100, -100, -100,   80,   68,   71, -100, -100, -100]],
       device='cuda:0')} labels None None None None None None None None None None None None None None None None None None None None None None pretrain
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/run.py", line 113, in <module>
    m.train(m.config.pretrain_data, batch_size = batch_size, epochs = 1, save_model = False)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 131, in train
    self._contrastive_pretrain(
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 203, in _contrastive_pretrain
    pretrain_trainer.train()
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/transformers/trainer.py", line 2481, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 93, in training_step
    loss = self.compute_loss(model, inputs)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 76, in compute_loss
    outputs = model(
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/bert/bert_review.py", line 177, in forward
    return self.forward_pretrain(
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/bert/bert_review.py", line 447, in forward_pretrain
    z_context_representation, z_context_pooled = self.bert(
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/bert/bert_model.py", line 1265, in forward
    raise ValueError("You have to specify either input_ids or inputs_embeds")
ValueError: You have to specify either input_ids or inputs_embeds
Traceback (most recent call last):
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/run.py", line 113, in <module>
    m.train(m.config.pretrain_data, batch_size = batch_size, epochs = 1, save_model = False)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 131, in train
    self._contrastive_pretrain(
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 203, in _contrastive_pretrain
    pretrain_trainer.train()
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/transformers/trainer.py", line 2481, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 93, in training_step
    loss = self.compute_loss(model, inputs)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/pretrain.py", line 76, in compute_loss
    outputs = model(
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/bert/bert_review.py", line 177, in forward
    return self.forward_pretrain(
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/bert/bert_review.py", line 447, in forward_pretrain
    z_context_representation, z_context_pooled = self.bert(
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yamanishi/.pyenv/versions/miniconda3-latest/envs/berttrip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yamanishi/project/airport/src/analysis/route_recommendation/BERT-Trip/BERT_Trip_Review/model/bert/bert_model.py", line 1265, in forward
    raise ValueError("You have to specify either input_ids or inputs_embeds")
ValueError: You have to specify either input_ids or inputs_embeds
